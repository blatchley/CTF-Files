#from math import ceil

def isqrt(n):
  x = n
  y = (x + n // x) // 2
  while y < x:
    x = y
    y = (x + n // x) // 2
  return x

def fermat(n, verbose=True):
    a = isqrt(n) # int(ceil(n**0.5))
    b2 = a*a - n
    b = isqrt(n) # int(b2**0.5)
    count = 0
    while b*b != b2:
        if verbose:
            print('Trying: a=%s b2=%s b=%s' % (a, b2, b))
        a = a + 1
        b2 = a*a - n
        b = isqrt(b2) # int(b2**0.5)
        count += 1
    p=a+b
    q=a-b
    assert n == p * q
    print('a=',a)
    print('b=',b)
    print('p=',p)
    print('q=',q)
    print('pq=',p*q)
    return p, q

fermat(19397174317041845307199150402764854385260291879847670410720605334071054817227635805582449604365870467675501554939061818058932547184772290076353108225371001445408144213180922291867880616250462098859412585776077091081682647498344626121642266542456616179955367507071827991706961404725805098154826550776784089673780971580396785447291096567964411297841600015399387624578228144364838847254766040616773931335832357351401204243097006867572803551239100465503332001883040243053328272542834995653592876187039734076167451473685956841778636396778701485287718225576274398667769554979755307158333403002848767169418093610096422581599)